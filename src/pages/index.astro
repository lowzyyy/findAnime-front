---
import Layout from "@layouts/Layout.astro";
import GenreList from "@components/GenreList/GenreList";
import SeasonalAnimeCarousel from "@components/SeasonalAnime/SeasonAnimeCarousel";
import TopAnime from "@components/TopAnimeSection/TopAiringAnime/TopAiringAnime";
import TopAnimeSection from "@components/TopAnimeSection/TopAnimeSection";

import { fetchAnimeGenres } from "../helpers/index/fetchGenres";
import { fetchSeasonalAnime } from "../helpers/index/fetchSeasonalAnime";
import { fetchTopAnime } from "../helpers/index/fetchTopAnime";
import "@fontsource-variable/rubik";

// const API = "http://127.0.0.1:3103";
const API = "https://findanime.up.railway.app";

// const API =await getApi()
const allGenre = await fetchAnimeGenres(API);
const seasonalAnime = await fetchSeasonalAnime(API);
const allTopAnime = await fetchTopAnime(API);
---

<Layout title="Welcome to FindAnime!">
  {
    allGenre ? (
      <GenreList client:visible data={allGenre} />
    ) : (
      <p>Cannot get anime gengre!</p>
    )
  }
  {
    seasonalAnime ? (
      <SeasonalAnimeCarousel client:visible seasonalAnime={seasonalAnime} />
    ) : (
      <p>Cannot get top anime!</p>
    )
  }
  {
    allTopAnime ? (
      <TopAnimeSection>
        <TopAnime title="Top Airing" topAnime={allTopAnime.topAiring.data} />
        <TopAnime title="Top Upcoming" topAnime={allTopAnime.topUpcoming.data} />
        <TopAnime title="Most Popular" topAnime={allTopAnime.mostPopular.data} />
      </TopAnimeSection>
    ) : (
      <p>Cannot get top anime!</p>
    )
  }
</Layout>

<style is:global>
  * {
    box-sizing: border-box;
    padding: 0;
    margin: 0;
  }
  html {
    background-color: #e0f2fe;
  }

  div,
  ul {
    scrollbar-width: none;
  }
  ul::-webkit-scrollbar {
    display: none;
  }
  ul::-webkit-scrollbar {
    display: none;
  }
</style>
